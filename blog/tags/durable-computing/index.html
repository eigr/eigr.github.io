<!doctype html>
<html lang="en" dir="ltr" class="blog-wrapper blog-tags-post-list-page plugin-blog plugin-id-default">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v2.1.0">
<title data-rh="true">One post tagged with &quot;durable computing&quot; | eigr.io</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" property="og:image" content="https://eigr.io/icon/eigr_flat.svg"><meta data-rh="true" name="twitter:image" content="https://eigr.io/icon/eigr_flat.svg"><meta data-rh="true" property="og:url" content="https://eigr.io/blog/tags/durable-computing/"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="twitter:card" content="summary"><meta data-rh="true" name="twitter:title" content="eigr.io â€“ A Serverless Runtime on the BEAM"><meta data-rh="true" property="og:title" content="One post tagged with &quot;durable computing&quot; | eigr.io"><meta data-rh="true" name="docusaurus_tag" content="blog_tags_posts"><meta data-rh="true" name="docsearch:docusaurus_tag" content="blog_tags_posts"><link data-rh="true" rel="icon" href="/icon/eigr_flat.ico?v=3"><link data-rh="true" rel="canonical" href="https://eigr.io/blog/tags/durable-computing/"><link data-rh="true" rel="alternate" href="https://eigr.io/blog/tags/durable-computing/" hreflang="en"><link data-rh="true" rel="alternate" href="https://eigr.io/blog/tags/durable-computing/" hreflang="x-default"><link rel="alternate" type="application/rss+xml" href="/blog/rss.xml" title="eigr.io RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/blog/atom.xml" title="eigr.io Atom Feed"><link rel="stylesheet" href="/assets/css/styles.fd39a121.css">
<link rel="preload" href="/assets/js/runtime~main.90521361.js" as="script">
<link rel="preload" href="/assets/js/main.7cc3888a.js" as="script">
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div role="region" aria-label="theme.common.skipToMainContent"><a href="#" class="skipToContent_fXgn">Skip to main content</a></div><nav class="navbar navbar--fixed-top navbar--dark"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/eigr_one_square_no_bg_001.svg" alt="eigr" class="themedImage_ToTc themedImage--light_HNdA"><img src="/img/eigr_one_square_no_bg_001.svg" alt="eigr" class="themedImage_ToTc themedImage--dark_i4oU"></div><b class="navbar__title text--truncate"></b></a><a class="navbar__item navbar__link" href="/docs/overview/">Documentation</a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/blog/">Blog</a><a class="navbar__item navbar__link" href="/protodocs/eigr/functions/protocol/actors/protocol.proto/">Spawn Protocol</a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/eigr" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="searchBox_ZlJk"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div class="main-wrapper mainWrapper_z2l0"><div class="container margin-vert--lg"><div class="row"><aside class="col col--3"><nav class="sidebar_re4s thin-scrollbar" aria-label="Blog recent posts navigation"><div class="sidebarItemTitle_pO2u margin-bottom--md">Recent posts</div><ul class="sidebarItemList_Yudw clean-list"><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/distributed-elixir-made-easy-with-spawn/">Distributed Elixir made easy with Spawn</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/beyond-monoliths-and-microservices/">Beyond Monoliths and Microservices</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/spawn-the-actor-mesh/">Hello Spawn! â€“ The Actor Mesh</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/current-status-of-the-project/">May 2022 â€“ Status of the Project</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/codebeam-sto-2022/">CodeBEAM Europe, Stockholm 2022</a></li></ul></nav></aside><main class="col col--7" itemscope="" itemtype="http://schema.org/Blog"><header class="margin-bottom--xl"><h1>One post tagged with &quot;durable computing&quot;</h1><a href="/blog/tags/">View All Tags</a></header><article class="margin-bottom--xl" itemprop="blogPost" itemscope="" itemtype="http://schema.org/BlogPosting"><header><h2 class="title_f1Hy" itemprop="headline"><a itemprop="url" href="/blog/distributed-elixir-made-easy-with-spawn/">Distributed Elixir made easy with Spawn</a></h2><div class="container_mt6G margin-vert--md"><time datetime="2023-12-03T00:00:00.000Z" itemprop="datePublished">December 3, 2023</time> Â· <!-- -->10 min read</div><div class="margin-top--md margin-bottom--sm row"><div class="col col--6 authorCol_Hf19"><div class="avatar margin-bottom--sm"><a href="https://github.com/eliasdarruda" target="_blank" rel="noopener noreferrer" class="avatar__photo-link"><img class="avatar__photo" src="https://avatars.githubusercontent.com/u/19327513?v=4" alt="Elias Dal Ben Arruda"></a><div class="avatar__intro" itemprop="author" itemscope="" itemtype="https://schema.org/Person"><div class="avatar__name"><a href="https://github.com/eliasdarruda" target="_blank" rel="noopener noreferrer" itemprop="url"><span itemprop="name">Elias Dal Ben Arruda</span></a></div><small class="avatar__subtitle" itemprop="description">eigr.io â€“ Core Team</small></div></div></div><div class="col col--6 authorCol_Hf19"><div class="avatar margin-bottom--sm"><a href="https://github.com/sleipnir" target="_blank" rel="noopener noreferrer" class="avatar__photo-link"><img class="avatar__photo" src="https://avatars.githubusercontent.com/u/342502?v=4" alt="Adriano Santos"></a><div class="avatar__intro" itemprop="author" itemscope="" itemtype="https://schema.org/Person"><div class="avatar__name"><a href="https://github.com/sleipnir" target="_blank" rel="noopener noreferrer" itemprop="url"><span itemprop="name">Adriano Santos</span></a></div><small class="avatar__subtitle" itemprop="description">eigr.io â€“ Core Team</small></div></div></div></div></header><div class="markdown" itemprop="articleBody"><p>Hello Elixir enthusiasts! ðŸš€ As the tech landscape evolves, so should our tools and approaches to development. Today, I&#x27;m excited to introduce you to a significant advancement in Elixir development that can reshape how we build distributed systems â€“ I present to you Spawn.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="the-elixir-actors-dilemma">The Elixir Actors Dilemma<a class="hash-link" href="#the-elixir-actors-dilemma" title="Direct link to heading">â€‹</a></h2><p>We&#x27;ve all been there â€“ struck by that stroke of genius while working with Elixir. The allure of in-memory state storage, backed by the reliability of Erlang/OTP, seems like a dream come true. But reality hits hard, especially in the realm of production environments where Kubernetes often plays a pivotal role. Managing multiple servers autonomously, especially in distributed systems, can quickly turn our dream into a complex nightmare.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="enter-spawn-a-new-approach-to-actors">Enter Spawn: A New Approach to Actors<a class="hash-link" href="#enter-spawn-a-new-approach-to-actors" title="Direct link to heading">â€‹</a></h2><p><a href="https://github.com/eigr/spawn" target="_blank" rel="noopener noreferrer"><strong>Spawn</strong></a> is not just another framework; it&#x27;s a paradigm shift in how we implement code. Imagine a world where you can care less about the underlying infrastructure and instead focus on crafting the domain-specific logic that truly matters. That&#x27;s precisely what Spawn brings to the table.</p><p>Let&#x27;s delve into a quick comparison between a traditional GenServer approach and the innovative Spawn Actor using the <a href="https://github.com/eigr/spawn/tree/main/spawn_sdk/spawn_sdk" target="_blank" rel="noopener noreferrer"><strong><em>Spawn Elixir SDK</em></strong></a>.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="consider-a-genserver-that-does-the-following">Consider a GenServer that does the following:<a class="hash-link" href="#consider-a-genserver-that-does-the-following" title="Direct link to heading">â€‹</a></h3><div class="language-ELIXIR codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-ELIXIR codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">defmodule Incrementor do</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  use GenServer</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  defmodule State do</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    defstruct [total: 0]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  end</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  def init(_), do: {:ok, %State{total: 0}}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  def handle_call({:add, value}, _from, state) do</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    new_total = state.total + value</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    {:reply, {:ok, %{total: new_total}}, %State{state | total: new_total}}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  end</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">end</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>If we execute it, as you probably now already, we can add a specified value to the total stored in memory, and calling add will always return the total amount stored in memory.</p><div class="language-Elixir codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-Elixir codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">iex(1)&gt; {:ok, pid} = GenServer.start_link(Incrementor, [])</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">iex(2)&gt; GenServer.call(pid, {:add, 1})</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">{:ok, %{total: 1}}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">iex(3)&gt; GenServer.call(pid, {:add, 1})</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">{:ok, %{total: 2}}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="with-spawn-the-same-definition-would-look-like">With Spawn, the same definition would look like:<a class="hash-link" href="#with-spawn-the-same-definition-would-look-like" title="Direct link to heading">â€‹</a></h3><p>Our process defined by the <code>GenServer</code>, we call it an <em>Actor</em>.</p><div class="language-ELIXIR codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-ELIXIR codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">defmodule IncrementorActor do</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  use SpawnSdk.Actor,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    name: &quot;incrementor&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    kind: :named,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    state_type: :json,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    deactivate_timeout: 30_000,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    snapshot_timeout: 10_000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  defmodule State do</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    @derive {Jason.Encoder, only: [:total]}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    defstruct [total: 0]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  end</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  defact init(%Context{} = ctx), do: Value.noreply_state!(ctx.state || %State{})</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  defact add(%{value: value}, %Context{} = ctx) do</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    new_total = ctx.state.total + value</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Value.of()</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    |&gt; Value.state(%State{total: new_total})</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    |&gt; Value.response(%{total: new_total})</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  end</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">end</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Our application would look like:</p><div class="language-ELIXIR codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-ELIXIR codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">defmodule Example.Application do</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  @moduledoc false</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  use Application</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  @impl true</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  def start(_type, _args) do</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    children = [</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        SpawnSdk.System.Supervisor,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        system: &quot;spawn-system&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        actors: [</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          IncrementorActor</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        ]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    ]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    opts = [strategy: :one_for_one, name: Example.Supervisor]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Supervisor.start_link(children, opts)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  end</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">end</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>And the SDK can be installed in your Elixir project with:</p><div class="language-ELIXIR codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-ELIXIR codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">[</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  {:spawn_sdk, &quot;~&gt; 1.1&quot;},</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  # if using stateful actors</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  # {:spawn_statestores_mysql, &quot;~&gt; 1.1&quot;}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  # {:spawn_statestores_postgres, &quot;~&gt; 1.1&quot;}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  # ... others</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">]</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>When using a statestore, you need to define a statestore key in <code>config.exs</code> or using <code>SPAWN_STATESTORE_KEY</code> environment variable to make sure your actor state is properly encrypted.</p><blockquote><p><strong>NOTE:</strong> It is <strong>recommended</strong> to securely store the key in the environment where it is being used.</p></blockquote><div class="language-ELIXIR codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-ELIXIR codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">config :spawn_statestores, statestore_key: &quot;secure_database_key&quot;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Having that defined, the same for <code>Calling</code> or <code>Casting</code> a process in a GenServer, we do it with <code>invoke</code>.</p><p>Passing any message we want in the payload attribute, it needs to be a struct or map that can be encoded to JSON or a protobuf struct.</p><div class="language-Elixir codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-Elixir codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">iex(1)&gt; SpawnSdk.invoke(&quot;incrementor&quot;, system: &quot;spawn-system&quot;, action: &quot;add&quot;, payload: %{value: 1})</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">{:ok, %{total: 1}}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><blockquote><p><strong><em>NOTE</em></strong>: We <strong>recommend</strong> to use protobufs as payload and also the state definition, with: <code>state_type: Protos.YourStateType</code>, however for this example for the sake of simplicity we are using JSON.</p></blockquote><h2 class="anchor anchorWithStickyNavbar_LWe7" id="unpacking-the-magic-answers-to-your-questions">Unpacking the Magic: Answers to Your Questions<a class="hash-link" href="#unpacking-the-magic-answers-to-your-questions" title="Direct link to heading">â€‹</a></h2><ol><li>What exactly is &quot;spawn-system&quot;?</li></ol><p>Spawn operates as a platform that manages infrastructure for you. &quot;spawn-system&quot; is a configuration entity encapsulating multiple actors within a meaningful context.</p><ol start="2"><li>Why is it an SDK?</li></ol><p>Spawn embraces a multi-language approach. SDKs allow different actors, even in different languages, to register with Spawn. For instance, you could have Elixir and NodeJS actors running the same logic seamlessly.</p><ol start="3"><li>How do I run it?</li></ol><p>In development, you can use Spawn as a lib. For production, use Kubernetes CRDs provided by Spawn for easy and scalable deployment.</p><ol start="4"><li>How do we handle state persistence?</li></ol><p>Spawn intelligently handles state persistence through well-defined timeouts and snapshot mechanisms, ensuring reliability even during rollouts.</p><ol start="5"><li>Why not just use a GenServer?</li></ol><p>Managing a distributed system with GenServer requires tackling numerous challenges. Spawn abstracts away these complexities, allowing you to focus on your domain logic without getting lost in infrastructure intricacies.</p><p>Two items above deserve a little more comment:</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="actor-system">Actor System<a class="hash-link" href="#actor-system" title="Direct link to heading">â€‹</a></h3><p>Spawn is a platform that also handles infrastructure for you, we run on top of kubernetes and have defined some <a href="https://kubernetes.io/docs/concepts/extend-kubernetes/api-extension/custom-resources/" target="_blank" rel="noopener noreferrer"><strong>Kubernetes CRDs</strong></a> that helps you configure the clustering and lifecycle of your actors.</p><p>A system is an entity that encapsulates multiple Actors in a context that makes sense for you.</p><p>We can configure one using the pre-defined Spawn CRDs, and we will also be configuring here which persistent database we are going to use to hold our Actors state.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="sdks">SDKs<a class="hash-link" href="#sdks" title="Direct link to heading">â€‹</a></h3><p>We can have multiple actors in the same system, with different SDKs registering those actors.
We call each deployment that uses an SDK an &quot;ActorHost.&quot;</p><p>In our example, we could have two SDKs, Elixir and NodeJS, running the same actor or different ones.
Spawn will then forward any invocations for one of those registered SDKs, with the specified implementation for each action.
You can even invoke an actor registered in a different system or in the same system from another SDK.</p><p>For instance, if we wanted to invoke the same actor we wrote but in a <a href="https://github.com/eigr/spawn-node-sdk" target="_blank" rel="noopener noreferrer">NodeJS ActorHost</a>, it would look like this:</p><div class="language-TS codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-TS codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">import spawn from &#x27;@eigr/spawn-sdk&#x27;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">const response = await spawn.invoke(&#x27;incrementor&#x27;, {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  action: &#x27;add&#x27;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  system: &#x27;spawn-system&#x27;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  payload: {value: 5}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">})</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">console.log(response)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// { total: 6 }</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>This way, we can interact with each actor globally, across different Systems and ActorHosts, while still maintaining the same state handling mechanism. And the best part? We can achieve all of this without the need for transactions, locks, or any additional infrastructure to support sequential state write changes of that nature.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="that-sounds-magical-how-do-i-run-it">That sounds magical, how do I run it?<a class="hash-link" href="#that-sounds-magical-how-do-i-run-it" title="Direct link to heading">â€‹</a></h3><p>In development mode for Elixir, you can take advantage of using Spawn as a lib, you&#x27;ll be able to use all the features you wan&#x27;t in a single runtime.</p><p>However for production we <strong>recommend</strong> using our CRDs set up for you.</p><p>First of all you need to install our k8s CRD with the following manifest (using kubectl):</p><div class="language-BASH codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-BASH codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">kubectl create ns eigr-functions &amp;&amp; curl -L https://github.com/eigr/spawn/releases/download/v1.1.1/manifest.yaml | kubectl apply -f -</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><blockquote><p><strong><em>NOTE:</em></strong> You need to inform the desired release version. Check our github to see the latest one released.</p></blockquote><p>After installing it successfully, you need now to configure your System:</p><div class="language-yaml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-yaml codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token key atrule" style="color:#00a4db">apiVersion</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> spawn</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">eigr.io/v1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">kind</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> ActorSystem</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">metadata</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">name</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> spawn</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">system </span><span class="token comment" style="color:#999988;font-style:italic"># Mandatory. Name of the ActorSystem</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">namespace</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> default </span><span class="token comment" style="color:#999988;font-style:italic"># Optional. Default namespace is &quot;default&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">spec</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">statestore</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">type</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> MySql </span><span class="token comment" style="color:#999988;font-style:italic"># Valid are [Postgres, MySql, MariaDB, Sqlite, MSSQL, CockroachDB]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">credentialsSecretRef</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> mysql</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">connection</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">secret </span><span class="token comment" style="color:#999988;font-style:italic"># The secret containing connection params created in the previous step.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">pool</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic"># Optional</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token key atrule" style="color:#00a4db">size</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;10&quot;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>You can generate the credentialsSecret or use whatever secret you are using to store your database credentials.
An example would be, note that the secret needs to be created at the namespace <code>eigr-functions</code>.</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">kubectl create secret generic mysql-connection-secret -n eigr-functions </span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --from-literal</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">database</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">eigr-functions-db </span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --from-literal</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">host</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&#x27;mysql&#x27;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --from-literal</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">port</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&#x27;3306&#x27;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --from-literal</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">username</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&#x27;admin&#x27;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --from-literal</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">password</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&#x27;admin&#x27;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --from-literal</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">encryptionKey</span><span class="token operator" style="color:#393A34">=</span><span class="token variable" style="color:#36acaa">$(</span><span class="token variable" style="color:#36acaa">openssl rand -base64 </span><span class="token variable number" style="color:#36acaa">32</span><span class="token variable" style="color:#36acaa">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>After installing the system, you will need to register your ActorHost, that can look like:</p><div class="language-yaml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-yaml codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token key atrule" style="color:#00a4db">apiVersion</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> spawn</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">eigr.io/v1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">kind</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> ActorHost</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">metadata</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">name</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> elixir</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">example</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">namespace</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> default</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">annotations</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">spawn-eigr.io/actor-system</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> spawn</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">system</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">spec</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">host</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">image</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> org/your</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">host</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">image</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain">0.0.1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">embedded</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token boolean important" style="color:#36acaa">true</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic"># this is only for Elixir Sdks, you can ignore this if you will use another language</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">ports</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">name</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;http&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token key atrule" style="color:#00a4db">containerPort</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">8800</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">autoscaler</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">min</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">max</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">2</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Just by applying this configuration, and having a container that has the application with the example we wrote in the start of the article, we should see
the instances starting that should handle the clustering and all the heavy insfrastructure work for you.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="managing-state-resilience-with-spawn">Managing State Resilience with Spawn<a class="hash-link" href="#managing-state-resilience-with-spawn" title="Direct link to heading">â€‹</a></h2><p>In the realm of Spawn, we prioritize the resilience of your application&#x27;s state. Each actor in Spawn comes with configurable parameters, namely the snapshot_timeout and deactivate_timeout. Let&#x27;s delve into these settings:</p><ul><li><p><strong>deactivate_timeout</strong> determines the duration (in milliseconds) your actor remains actively in memory, even when not in use.</p></li><li><p><strong>snapshot_timeout</strong> how frequently snapshots of your actor&#x27;s state are saved in your persistent storage.</p></li></ul><p>The magic unfolds after an actor is deactivated, triggered either by the specified timeout or during a Kubernetes rollout. In this scenario, Spawn meticulously manages the lifecycle of each process, ensuring that the state is gracefully saved in the configured persistent storage.</p><p>Here&#x27;s the key assurance: even in the face of failures, crashes, or net-splits, Spawn guarantees that the state of your application will always revert to the last valid state. This means if an instance fails, another node seamlessly takes over from where it left off, ensuring the continuity and integrity of your application&#x27;s data. Our meticulous tuning of Custom Resource Definitions (CRDs) and signal handling ensures that you won&#x27;t lose data during rollouts or network partitions.</p><p>With Spawn, you can confidently embrace a resilient state management model, where the reliability and consistency of your application&#x27;s data are at the forefront of our design philosophy.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="unleashing-gains-in-agility-and-innovation-with-spawn">Unleashing Gains in Agility and Innovation with Spawn<a class="hash-link" href="#unleashing-gains-in-agility-and-innovation-with-spawn" title="Direct link to heading">â€‹</a></h2><p>Beyond the facade of extensive configurations lies a treasure trove of advantages awaiting exploration. Spawn not only simplifies but significantly enriches your development experience. Imagine bidding farewell to the complexities of defining Kubernetes resources, the intricacies of rollouts, the considerations of HPA, and the worries of scalability, network configurations, and system integrity assessments.</p><p>Spawn emerges as the driving force behind a newfound sense of agility and innovation. It liberates you from the burdensome aspects of infrastructure management, allowing you to redirect your focus towards what truly matters â€“ crafting innovative solutions. Step into a future where complexities dissolve, and your journey into agile and innovative Elixir development begins with a resounding hello!</p><p>If you choose to go down that path, you will need to face at least the following challenges:</p><ul><li>Ensuring proper handling of connections between multiple nodes in your Erlang cluster.</li><li>Ensuring reliable and synchronized data rollouts to avoid message or state loss during instances rolling out.</li><li>Implementing effective persistence mechanisms to recover data in the event of netsplit scenarios, preventing data loss.</li><li>Managing the process lifecycle to ensure predictable recovery and maintain a consistent state in case of errors.</li><li>Designing a well-defined API that integrates your processes seamlessly with other systems, ensuring message synchronization.</li><li>Establishing a reliable distribution mechanism for sending messages to actors within your own edge, with the ability to synchronize them later.</li><li>Mitigating process queue bottlenecks to optimize performance and prevent delays.</li><li>Ensuring atomicity in a distributed system, maintaining data consistency and integrity.</li><li>Ensuring that you can concentrate on your domain-specific code without being burdened by unnecessary complexities and boilerplate.</li><li>Implementing seamless integration patterns, including process pipelines, customized activators, workflows, and effective management of side effects, among others.</li><li>Developing and managing infrastructure code related to brokers, caching, and other components.</li></ul><h2 class="anchor anchorWithStickyNavbar_LWe7" id="conclusion">Conclusion<a class="hash-link" href="#conclusion" title="Direct link to heading">â€‹</a></h2><p>This is more than just a practical example; it&#x27;s an invitation to explore the full potential of Spawn. For a deeper dive into the concepts and foundations, refer to our <a href="https://github.com/eigr/spawn" target="_blank" rel="noopener noreferrer">Spawn Full Documentation</a> and our insightful article <a href="https://eigr.io/blog/beyond-monoliths-and-microservices/" target="_blank" rel="noopener noreferrer">Beyond Monoliths and Microservices</a>.</p><p>Ready to elevate your Elixir development experience? Embrace the future with Spawn. Happy coding! ðŸš€âœ¨</p></div><footer class="row docusaurus-mt-lg"><div class="col"><b>Tags:</b><ul class="tags_jXut padding--none margin-left--sm"><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/blog/tags/spawn/">spawn</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/blog/tags/serverless/">serverless</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/blog/tags/elixir/">elixir</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/blog/tags/distributed/">distributed</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/blog/tags/durable-computing/">durable computing</a></li></ul></div></footer></article><nav class="pagination-nav" aria-label="Blog list page navigation"></nav></main></div></div></div><footer class="footer"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Community</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://discord.gg/Y55eZpyvNs" target="_blank" rel="noopener noreferrer" class="footer__link-item">Discord<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://twitter.com/eigr_io" target="_blank" rel="noopener noreferrer" class="footer__link-item">Twitter<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div><div class="col footer__col"><div class="footer__title">More</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/blog/">Blog</a></li><li class="footer__item"><a href="https://github.com/eigr" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright Â© 2023 â€“ eigr.io | graphics design by <a href="https://ursulahitz.com">ursulahitz.com</a></div></div></div></footer></div>
<script src="/assets/js/runtime~main.90521361.js"></script>
<script src="/assets/js/main.7cc3888a.js"></script>
</body>
</html>